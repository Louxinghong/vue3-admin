import{d as V,h as v,r as i,o as f,c as y,a as l,_ as w,f as b,w as c,b as g,v as j,x as ee,F as N,i as D,l as J,t as C,M as T,p as te,e as ae,q as oe,y as se,z as ne,A as O,B as L}from"./index-0fcf21c4.js";import{g as le}from"./index-0545d4c3.js";const ue={class:"excel-to-json"},re=V({__name:"ExcelToJson",setup(t){const e=v([]),a=o=>{e.value=o};return(o,r)=>{const s=i("file-upload"),n=i("json-viewer");return f(),y("div",ue,[l(s,{onSuccess:a}),l(n,{class:"json-viewer",value:e.value,copyable:!0,"expand-depth":2,boxed:""},null,8,["value"])])}}});const ce=w(re,[["__scopeId","data-v-f5177d8d"]]),de={class:"json-to-excel"},ie={class:"type-select"},_e=V({__name:"JsonToExcel",setup(t){const e=v("single"),a=v(""),o=()=>{const r=j.book_new();if(e.value==="single"){const s=j.json_to_sheet(JSON.parse(a.value));j.book_append_sheet(r,s,"data")}else JSON.parse(a.value).map(s=>{const n=j.json_to_sheet(s.sheetList);j.book_append_sheet(r,n,s.sheetName)});ee(r,"测试表格.xlsx")};return(r,s)=>{const n=i("a-radio"),_=i("a-radio-group"),h=i("a-textarea"),x=i("svg-icon"),M=i("a-button");return f(),y("div",de,[b("div",ie,[l(_,{modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=u=>e.value=u)},{default:c(()=>[l(n,{value:"single"},{default:c(()=>[g("单表")]),_:1}),l(n,{value:"batch"},{default:c(()=>[g("多表")]),_:1})]),_:1},8,["modelValue"])]),l(h,{class:"json-excel",placeholder:"请输入JSON内容",modelValue:a.value,"onUpdate:modelValue":s[1]||(s[1]=u=>a.value=u)},null,8,["modelValue"]),l(M,{class:"btn-convert-json",type:"primary",onClick:o},{icon:c(()=>[l(x,{name:"convert",size:"15px"})]),default:c(()=>[g(" 转换EXCEL ")]),_:1})])}}});const pe=w(_e,[["__scopeId","data-v-c318f0ee"]]);let E=3.141592653589793*3e3/180,m=3.141592653589793,S=6378245,U=.006693421622965943;const H=(t,e)=>{let a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=(20*Math.sin(6*t*m)+20*Math.sin(2*t*m))*2/3,a+=(20*Math.sin(t*m)+40*Math.sin(t/3*m))*2/3,a+=(150*Math.sin(t/12*m)+300*Math.sin(t/30*m))*2/3,a},F=(t,e)=>{let a=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return a+=(20*Math.sin(6*t*m)+20*Math.sin(2*t*m))*2/3,a+=(20*Math.sin(e*m)+40*Math.sin(e/3*m))*2/3,a+=(160*Math.sin(e/12*m)+320*Math.sin(e*m/30))*2/3,a},R=(t,e)=>t<72.004||t>137.8347||e<.8293||e>55.8271||!1,P=(t,e)=>{if(t=Number(t),e=Number(e),R(t,e))return[t,e];{let a=F(t-105,e-35),o=H(t-105,e-35),r=e/180*m,s=Math.sin(r);s=1-U*s*s;let n=Math.sqrt(s);a=a*180/(S*(1-U)/(s*n)*m),o=o*180/(S/n*Math.cos(r)*m);let _=e+a;return[t+o,_]}},z=(t,e)=>{const a=P(t,e);return Y(a[0],a[1])},B=(t,e)=>{let a=t-.0065,o=e-.006,r=Math.sqrt(a*a+o*o)-2e-5*Math.sin(o*E),s=Math.atan2(o,a)-3e-6*Math.cos(a*E),n=r*Math.cos(s),_=r*Math.sin(s);return[n,_]},ve=(t,e)=>{const a=B(t,e);return W(a[0],a[1])},Y=(t,e)=>{let a=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*E),o=Math.atan2(e,t)+3e-6*Math.cos(t*E),r=a*Math.cos(o)+.0065,s=a*Math.sin(o)+.006;return[r,s]},W=(t,e)=>{if(R(t,e))return[t,e];{let a=F(t-105,e-35),o=H(t-105,e-35),r=e/180*m,s=Math.sin(r);s=1-U*s*s;let n=Math.sqrt(s);a=a*180/(S*(1-U)/(s*n)*m),o=o*180/(S/n*Math.cos(r)*m);let _=e+a,h=t+o;return[t*2-h,e*2-_]}},me=(t,e,a)=>new Promise((o,r)=>{t.plugin("AMap.Geocoder",()=>{new t.Geocoder().getAddress([e,a],(s,n)=>{if(s==="complete"&&n.info==="OK"){const _=n.regeocode.formattedAddress;o(_)}else r(null)})})}),q=t=>(te("data-v-93e3bba9"),t=t(),ae(),t),be={class:"coordinate-convert"},fe={class:"type-select"},he={class:"coordinate-type-select"},ge=q(()=>b("span",null,"坐标系 : ",-1)),xe={class:"initial-coordinate"},ye=q(()=>b("span",null,"坐标 : ",-1)),Me={class:"result-coordinate"},Ve={class:"coordinate-type-select"},je=q(()=>b("span",null,"目标坐标系 : ",-1)),Ce={class:"batch-coordinate-result"},we=V({__name:"CoordinateConvert",setup(t){const e=v("single"),a=v(""),o=v([{label:"WGS84(国际通用)",value:"wgs84"},{label:"BD09(百度地图)",value:"bd09"},{label:"GCJ02(高德、QQ地图)",value:"gcj02"}]),r=v(""),s=v({wgs84:"",gcj02:"",bd09:"",address:""}),n=v(""),_=v(""),h=v(!1),x=v(""),M=async()=>{if(!a.value){T.warning("请选择初始坐标系类型");return}if(e.value==="single"){if(!r.value){T.warning("请输入初始坐标");return}const u=r.value.split(",");switch(s.value[a.value]=r.value,a.value){case"wgs84":s.value.gcj02=P(Number(u[0]),Number(u[1])).join(","),s.value.bd09=z(Number(u[0]),Number(u[1])).join(",");break;case"gcj02":s.value.wgs84=W(Number(u[0]),Number(u[1])).join(","),s.value.bd09=Y(Number(u[0]),Number(u[1])).join(",");break;case"bd09":s.value.wgs84=ve(Number(u[0]),Number(u[1])).join(","),s.value.gcj02=B(Number(u[0]),Number(u[1])).join(",");break}}else{if(!n.value||!_.value){T.warning(n.value?"请选择目标坐标系类型":"请输入初始坐标");return}if(a.value===_.value){T.warning("经纬度初始类型与转换类型一致");return}h.value=!0;let u=[];switch(_.value){case"wgs84":u=n.value.split(`
`).map(p=>z(Number(p.split(",")[0]),Number(p.split(",")[1])).join(","));break;case"gcj02":u=n.value.split(`
`).map(p=>Y(Number(p.split(",")[0]),Number(p.split(",")[1])).join(","));break;case"bd09":u=n.value.split(`
`).map(p=>B(Number(p.split(",")[0]),Number(p.split(",")[1])).join(","));break}x.value=u.join(`
`)}};return(u,p)=>{const k=i("a-radio"),$=i("a-radio-group"),X=i("a-input"),A=i("svg-icon"),I=i("a-button"),Q=i("temlpate"),K=i("a-textarea"),Z=i("a-modal");return f(),y("div",be,[b("div",fe,[l($,{modelValue:e.value,"onUpdate:modelValue":p[0]||(p[0]=d=>e.value=d)},{default:c(()=>[l(k,{value:"single"},{default:c(()=>[g("单量")]),_:1}),l(k,{value:"batch"},{default:c(()=>[g("批量")]),_:1})]),_:1},8,["modelValue"])]),b("div",he,[ge,l($,{modelValue:a.value,"onUpdate:modelValue":p[1]||(p[1]=d=>a.value=d)},{default:c(()=>[(f(!0),y(N,null,D(o.value,d=>(f(),J(k,{value:d.value,key:d.value},{default:c(()=>[g(C(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),e.value==="single"?(f(),J(Q,{key:0},{default:c(()=>[b("div",xe,[ye,l(X,{class:"coordinate-value",placeholder:"请输入经纬度(逗号隔开)","allow-clear":"",modelValue:r.value,"onUpdate:modelValue":p[2]||(p[2]=d=>r.value=d)},null,8,["modelValue"]),l(I,{type:"primary",onClick:M},{icon:c(()=>[l(A,{name:"convert",size:"15px"})]),default:c(()=>[g(" 转换 ")]),_:1})]),b("ul",Me,[(f(!0),y(N,null,D(o.value,d=>(f(),y("li",{key:d.value,class:"item-result"},[b("span",null,C(d.label),1),b("span",null,C(s.value[d.value]),1)]))),128))])]),_:1})):(f(),y(N,{key:1},[l(K,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:n.value,"onUpdate:modelValue":p[3]||(p[3]=d=>n.value=d)},null,8,["modelValue"]),b("div",Ve,[je,l($,{modelValue:_.value,"onUpdate:modelValue":p[4]||(p[4]=d=>_.value=d)},{default:c(()=>[(f(!0),y(N,null,D(o.value,d=>(f(),J(k,{value:d.value,key:d.value},{default:c(()=>[g(C(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),l(I,{type:"primary",onClick:M},{icon:c(()=>[l(A,{name:"convert",size:"15px"})]),default:c(()=>[g(" 转换 ")]),_:1}),l(Z,{visible:h.value,"onUpdate:visible":p[5]||(p[5]=d=>h.value=d)},{title:c(()=>[g(" 批量转换经纬度结果 ")]),default:c(()=>[b("div",Ce,C(x.value),1)]),_:1},8,["visible"])],64))])}}});const ke=w(we,[["__scopeId","data-v-93e3bba9"]]),Ne={class:"trans-address"},Te=V({__name:"TransAddress",setup(t){let e=v({});oe(async()=>{e=await le()});const a=v(""),o=v(""),r=async()=>{o.value="",await Promise.all(a.value.split(`
`).map(async s=>{const n=await me(e,s.split(",")[0],s.split(",")[1]);o.value?o.value+=`
${n}`:o.value=n}))};return(s,n)=>{const _=i("a-textarea"),h=i("svg-icon");return f(),y("div",Ne,[l(_,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=x=>a.value=x)},null,8,["modelValue"]),l(h,{class:"exchange",name:"exchange",size:"40px",onClick:r}),l(_,{class:"coordinate-list",modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=x=>o.value=x)},null,8,["modelValue"])])}}});const Ee=w(Te,[["__scopeId","data-v-c2ed5933"]]);var Se=se();const G=ne(Se),Ue={class:"timestamp-convert"},$e={class:"convert-content"},De={class:"convert-content"},Je=V({__name:"TimestampConvert",setup(t){const e=v(0),a=v(""),o=v(""),r=()=>{e.value===0&&(o.value=String(G(a.value).valueOf())),e.value===1&&(a.value=G(Number(o.value)).format("YYYY-MM-DD HH:mm:ss"))};return(s,n)=>{const _=i("a-radio"),h=i("a-radio-group"),x=i("a-date-picker"),M=i("a-input");return f(),y("div",Ue,[l(h,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=u=>e.value=u)},{default:c(()=>[l(_,{value:0},{default:c(()=>[g("时间转换时间戳")]),_:1}),l(_,{value:1},{default:c(()=>[g("时间戳转换时间")]),_:1})]),_:1},8,["modelValue"]),O(b("div",$e,[l(x,{modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=u=>a.value=u),"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"]),b("span",{class:"exchange",onClick:r},"->"),l(M,{class:"timestamp",modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=u=>o.value=u),placeholder:"请输入时间戳"},null,8,["modelValue"])],512),[[L,e.value===0]]),O(b("div",De,[l(M,{class:"timestamp",modelValue:o.value,"onUpdate:modelValue":n[3]||(n[3]=u=>o.value=u),placeholder:"请输入时间戳"},null,8,["modelValue"]),b("span",{class:"exchange",onClick:r},"->"),l(x,{modelValue:a.value,"onUpdate:modelValue":n[4]||(n[4]=u=>a.value=u),"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])],512),[[L,e.value===1]])])}}});const Be=w(Je,[["__scopeId","data-v-ddc8bbf8"]]),Ye={class:"data-conversion"},Ie=V({__name:"index",setup(t){return(e,a)=>{const o=i("a-tab-pane"),r=i("a-tabs");return f(),y("div",Ye,[l(r,{"default-active-key":"1"},{default:c(()=>[l(o,{key:"1",title:"EXCEL转JSON"},{default:c(()=>[l(ce)]),_:1}),l(o,{key:"2",title:"JSON转EXCEL"},{default:c(()=>[l(pe)]),_:1}),l(o,{key:"3",title:"坐标转换"},{default:c(()=>[l(ke)]),_:1}),l(o,{key:"4",title:"高德地址"},{default:c(()=>[l(Ee)]),_:1}),l(o,{key:"5",title:"时间戳转换"},{default:c(()=>[l(Be)]),_:1})]),_:1})])}}});export{Ie as default};
