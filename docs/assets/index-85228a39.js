import{d as h,h as m,r as _,o as b,c as M,a as l,_ as w,b as f,w as i,e as x,x as j,y as Z,F as N,i as J,p as B,t as C,M as T,l as ee,z as L,A as q,B as z}from"./index-f0f918b6.js";import{g as te}from"./index-c973117a.js";const ae={class:"excel-to-json"},oe=h({__name:"ExcelToJson",setup(a){const e=m([]),t=s=>{e.value=s};return(s,d)=>{const o=_("file-upload"),n=_("json-viewer");return b(),M("div",ae,[l(o,{onSuccess:t}),l(n,{class:"json-viewer",value:e.value,copyable:!0,"expand-depth":2,boxed:""},null,8,["value"])])}}});const se=w(oe,[["__scopeId","data-v-7e30fa6f"]]),ne={class:"json-to-excel"},le={class:"type-select"},ue=h({__name:"JsonToExcel",setup(a){const e=m("single"),t=m(""),s=()=>{const d=j.book_new();if(e.value==="single"){const o=j.json_to_sheet(JSON.parse(t.value));j.book_append_sheet(d,o,"data")}else JSON.parse(t.value).map(o=>{const n=j.json_to_sheet(o.sheetList);j.book_append_sheet(d,n,o.sheetName)});Z(d,"测试表格.xlsx")};return(d,o)=>{const n=_("a-radio"),p=_("a-radio-group"),g=_("a-textarea"),y=_("svg-icon"),V=_("a-button");return b(),M("div",ne,[f("div",le,[l(p,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=r=>e.value=r)},{default:i(()=>[l(n,{value:"single"},{default:i(()=>o[2]||(o[2]=[x("单表")])),_:1}),l(n,{value:"batch"},{default:i(()=>o[3]||(o[3]=[x("多表")])),_:1})]),_:1},8,["modelValue"])]),l(g,{class:"json-excel",placeholder:"请输入JSON内容",modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value=r)},null,8,["modelValue"]),l(V,{class:"btn-convert-json",type:"primary",onClick:s},{icon:i(()=>[l(y,{name:"convert",size:"15px"})]),default:i(()=>[o[4]||(o[4]=x(" 转换EXCEL "))]),_:1})])}}});const re=w(ue,[["__scopeId","data-v-8809c0af"]]);let E=3.141592653589793*3e3/180,v=3.141592653589793,U=6378245,S=.006693421622965943;const I=(a,e)=>{let t=300+a+2*e+.1*a*a+.1*a*e+.1*Math.sqrt(Math.abs(a));return t+=(20*Math.sin(6*a*v)+20*Math.sin(2*a*v))*2/3,t+=(20*Math.sin(a*v)+40*Math.sin(a/3*v))*2/3,t+=(150*Math.sin(a/12*v)+300*Math.sin(a/30*v))*2/3,t},H=(a,e)=>{let t=-100+2*a+3*e+.2*e*e+.1*a*e+.2*Math.sqrt(Math.abs(a));return t+=(20*Math.sin(6*a*v)+20*Math.sin(2*a*v))*2/3,t+=(20*Math.sin(e*v)+40*Math.sin(e/3*v))*2/3,t+=(160*Math.sin(e/12*v)+320*Math.sin(e*v/30))*2/3,t},R=(a,e)=>a<72.004||a>137.8347||e<.8293||e>55.8271||!1,F=(a,e)=>{if(a=Number(a),e=Number(e),R(a,e))return[a,e];{let t=H(a-105,e-35),s=I(a-105,e-35),d=e/180*v,o=Math.sin(d);o=1-S*o*o;let n=Math.sqrt(o);t=t*180/(U*(1-S)/(o*n)*v),s=s*180/(U/n*Math.cos(d)*v);let p=e+t;return[a+s,p]}},G=(a,e)=>{const t=F(a,e);return D(t[0],t[1])},Y=(a,e)=>{let t=a-.0065,s=e-.006,d=Math.sqrt(t*t+s*s)-2e-5*Math.sin(s*E),o=Math.atan2(s,t)-3e-6*Math.cos(t*E),n=d*Math.cos(o),p=d*Math.sin(o);return[n,p]},de=(a,e)=>{const t=Y(a,e);return P(t[0],t[1])},D=(a,e)=>{let t=Math.sqrt(a*a+e*e)+2e-5*Math.sin(e*E),s=Math.atan2(e,a)+3e-6*Math.cos(a*E),d=t*Math.cos(s)+.0065,o=t*Math.sin(s)+.006;return[d,o]},P=(a,e)=>{if(R(a,e))return[a,e];{let t=H(a-105,e-35),s=I(a-105,e-35),d=e/180*v,o=Math.sin(d);o=1-S*o*o;let n=Math.sqrt(o);t=t*180/(U*(1-S)/(o*n)*v),s=s*180/(U/n*Math.cos(d)*v);let p=e+t,g=a+s;return[a*2-g,e*2-p]}},ie=(a,e,t)=>new Promise((s,d)=>{a.plugin("AMap.Geocoder",()=>{new a.Geocoder().getAddress([e,t],(o,n)=>{if(o==="complete"&&n.info==="OK"){const p=n.regeocode.formattedAddress;s(p)}else d(null)})})}),ce={class:"coordinate-convert"},_e={class:"type-select"},pe={class:"coordinate-type-select"},ve={class:"initial-coordinate"},me={class:"result-coordinate"},fe={class:"coordinate-type-select"},be={class:"batch-coordinate-result"},ge=h({__name:"CoordinateConvert",setup(a){const e=m("single"),t=m(""),s=m([{label:"WGS84(国际通用)",value:"wgs84"},{label:"BD09(百度地图)",value:"bd09"},{label:"GCJ02(高德、QQ地图)",value:"gcj02"}]),d=m(""),o=m({wgs84:"",gcj02:"",bd09:"",address:""}),n=m(""),p=m(""),g=m(!1),y=m(""),V=async()=>{if(!t.value){T.warning("请选择初始坐标系类型");return}if(e.value==="single"){if(!d.value){T.warning("请输入初始坐标");return}const r=d.value.split(",");switch(o.value[t.value]=d.value,t.value){case"wgs84":o.value.gcj02=F(Number(r[0]),Number(r[1])).join(","),o.value.bd09=G(Number(r[0]),Number(r[1])).join(",");break;case"gcj02":o.value.wgs84=P(Number(r[0]),Number(r[1])).join(","),o.value.bd09=D(Number(r[0]),Number(r[1])).join(",");break;case"bd09":o.value.wgs84=de(Number(r[0]),Number(r[1])).join(","),o.value.gcj02=Y(Number(r[0]),Number(r[1])).join(",");break}}else{if(!n.value||!p.value){T.warning(n.value?"请选择目标坐标系类型":"请输入初始坐标");return}if(t.value===p.value){T.warning("经纬度初始类型与转换类型一致");return}g.value=!0;let r=[];switch(p.value){case"wgs84":r=n.value.split(`
`).map(u=>G(Number(u.split(",")[0]),Number(u.split(",")[1])).join(","));break;case"gcj02":r=n.value.split(`
`).map(u=>D(Number(u.split(",")[0]),Number(u.split(",")[1])).join(","));break;case"bd09":r=n.value.split(`
`).map(u=>Y(Number(u.split(",")[0]),Number(u.split(",")[1])).join(","));break}y.value=r.join(`
`)}};return(r,u)=>{const k=_("a-radio"),$=_("a-radio-group"),W=_("a-input"),A=_("svg-icon"),O=_("a-button"),X=_("temlpate"),Q=_("a-textarea"),K=_("a-modal");return b(),M("div",ce,[f("div",_e,[l($,{modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=c=>e.value=c)},{default:i(()=>[l(k,{value:"single"},{default:i(()=>u[6]||(u[6]=[x("单量")])),_:1}),l(k,{value:"batch"},{default:i(()=>u[7]||(u[7]=[x("批量")])),_:1})]),_:1},8,["modelValue"])]),f("div",pe,[u[8]||(u[8]=f("span",null,"坐标系 : ",-1)),l($,{modelValue:t.value,"onUpdate:modelValue":u[1]||(u[1]=c=>t.value=c)},{default:i(()=>[(b(!0),M(N,null,J(s.value,c=>(b(),B(k,{value:c.value,key:c.value},{default:i(()=>[x(C(c.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),e.value==="single"?(b(),B(X,{key:0},{default:i(()=>[f("div",ve,[u[10]||(u[10]=f("span",null,"坐标 : ",-1)),l(W,{class:"coordinate-value",placeholder:"请输入经纬度(逗号隔开)","allow-clear":"",modelValue:d.value,"onUpdate:modelValue":u[2]||(u[2]=c=>d.value=c)},null,8,["modelValue"]),l(O,{type:"primary",onClick:V},{icon:i(()=>[l(A,{name:"convert",size:"15px"})]),default:i(()=>[u[9]||(u[9]=x(" 转换 "))]),_:1})]),f("ul",me,[(b(!0),M(N,null,J(s.value,c=>(b(),M("li",{key:c.value,class:"item-result"},[f("span",null,C(c.label),1),f("span",null,C(o.value[c.value]),1)]))),128))])]),_:1})):(b(),M(N,{key:1},[l(Q,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:n.value,"onUpdate:modelValue":u[3]||(u[3]=c=>n.value=c)},null,8,["modelValue"]),f("div",fe,[u[11]||(u[11]=f("span",null,"目标坐标系 : ",-1)),l($,{modelValue:p.value,"onUpdate:modelValue":u[4]||(u[4]=c=>p.value=c)},{default:i(()=>[(b(!0),M(N,null,J(s.value,c=>(b(),B(k,{value:c.value,key:c.value},{default:i(()=>[x(C(c.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),l(O,{type:"primary",onClick:V},{icon:i(()=>[l(A,{name:"convert",size:"15px"})]),default:i(()=>[u[12]||(u[12]=x(" 转换 "))]),_:1}),l(K,{visible:g.value,"onUpdate:visible":u[5]||(u[5]=c=>g.value=c)},{title:i(()=>u[13]||(u[13]=[x(" 批量转换经纬度结果 ")])),default:i(()=>[f("div",be,C(y.value),1)]),_:1},8,["visible"])],64))])}}});const xe=w(ge,[["__scopeId","data-v-97032484"]]),ye={class:"trans-address"},Me=h({__name:"TransAddress",setup(a){let e={};ee(async()=>{e=await te()});const t=m(""),s=m(""),d=async()=>{s.value="",await Promise.all(t.value.split(`
`).map(async o=>{const n=await ie(e,o.split(",")[0],o.split(",")[1]);s.value?s.value+=`
${n}`:s.value=n}))};return(o,n)=>{const p=_("a-textarea"),g=_("svg-icon");return b(),M("div",ye,[l(p,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=y=>t.value=y)},null,8,["modelValue"]),l(g,{class:"exchange",name:"exchange",size:"40px",onClick:d}),l(p,{class:"coordinate-list",modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=y=>s.value=y)},null,8,["modelValue"])])}}});const Ve=w(Me,[["__scopeId","data-v-dd66fbf6"]]),he={class:"timestamp-convert"},je={class:"convert-content"},Ce={class:"convert-content"},we=h({__name:"TimestampConvert",setup(a){const e=m(0),t=m(""),s=m(""),d=()=>{e.value===0&&(s.value=String(z(t.value).valueOf())),e.value===1&&(t.value=z(Number(s.value)).format("YYYY-MM-DD HH:mm:ss"))};return(o,n)=>{const p=_("a-radio"),g=_("a-radio-group"),y=_("a-date-picker"),V=_("a-input");return b(),M("div",he,[l(g,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=r=>e.value=r)},{default:i(()=>[l(p,{value:0},{default:i(()=>n[5]||(n[5]=[x("时间转换时间戳")])),_:1}),l(p,{value:1},{default:i(()=>n[6]||(n[6]=[x("时间戳转换时间")])),_:1})]),_:1},8,["modelValue"]),L(f("div",je,[l(y,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=r=>t.value=r),"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"]),f("span",{class:"exchange",onClick:d},"->"),l(V,{class:"timestamp",modelValue:s.value,"onUpdate:modelValue":n[2]||(n[2]=r=>s.value=r),placeholder:"请输入时间戳"},null,8,["modelValue"])],512),[[q,e.value===0]]),L(f("div",Ce,[l(V,{class:"timestamp",modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=r=>s.value=r),placeholder:"请输入时间戳"},null,8,["modelValue"]),f("span",{class:"exchange",onClick:d},"->"),l(y,{modelValue:t.value,"onUpdate:modelValue":n[4]||(n[4]=r=>t.value=r),"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])],512),[[q,e.value===1]])])}}});const ke=w(we,[["__scopeId","data-v-089f32cc"]]),Ne={class:"data-conversion"},Ue=h({__name:"index",setup(a){return(e,t)=>{const s=_("a-tab-pane"),d=_("a-tabs");return b(),M("div",Ne,[l(d,{"default-active-key":"1"},{default:i(()=>[l(s,{key:"1",title:"EXCEL转JSON"},{default:i(()=>[l(se)]),_:1}),l(s,{key:"2",title:"JSON转EXCEL"},{default:i(()=>[l(re)]),_:1}),l(s,{key:"3",title:"坐标转换"},{default:i(()=>[l(xe)]),_:1}),l(s,{key:"4",title:"高德地址"},{default:i(()=>[l(Ve)]),_:1}),l(s,{key:"5",title:"时间戳转换"},{default:i(()=>[l(ke)]),_:1})]),_:1})])}}});export{Ue as default};
