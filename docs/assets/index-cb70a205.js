import{d as C,h as b,r as m,o as f,c as x,a as c,j as v,_ as J,k as M,w as d,b as j,v as U,x as $,f as g,F as V,l as q,m as A,t as w,M as k,p as ee,e as te,q as ae}from"./index-20b05db2.js";import{g as oe}from"./index-e905afc7.js";const se={class:"excel-to-json"},ne=C({__name:"ExcelToJson",setup(t){let e=b([]);const a=o=>{e.value=o};return(o,l)=>{const s=m("file-upload"),n=m("json-viewer");return f(),x("div",se,[c(s,{onSuccess:a}),c(n,{class:"json-viewer",value:v(e),copyable:!0,"expand-depth":2,boxed:""},null,8,["value"])])}}});const le=J(ne,[["__scopeId","data-v-7e0406bd"]]),re={class:"json-to-excel"},ce=C({__name:"JsonToExcel",setup(t){let e=b("");const a=()=>{const o=U.json_to_sheet(JSON.parse(e.value)),l=U.book_new();U.book_append_sheet(l,o,"data"),$(l,"测试表格.xlsx")};return(o,l)=>{const s=m("a-textarea"),n=m("svg-icon"),i=m("a-button");return f(),x("div",re,[c(s,{class:"json-excel",placeholder:"请输入JSON内容",modelValue:v(e),"onUpdate:modelValue":l[0]||(l[0]=h=>M(e)?e.value=h:e=h)},null,8,["modelValue"]),c(i,{class:"btn-convert-json",type:"primary",onClick:a},{icon:d(()=>[c(n,{name:"convert",size:"15px"})]),default:d(()=>[j(" 转换EXCEL ")]),_:1})])}}});const ue=J(ce,[["__scopeId","data-v-fc9f756d"]]);let T=3.141592653589793*3e3/180,p=3.141592653589793,E=6378245,S=.006693421622965943;const F=(t,e)=>{let a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=(20*Math.sin(6*t*p)+20*Math.sin(2*t*p))*2/3,a+=(20*Math.sin(t*p)+40*Math.sin(t/3*p))*2/3,a+=(150*Math.sin(t/12*p)+300*Math.sin(t/30*p))*2/3,a},P=(t,e)=>{let a=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return a+=(20*Math.sin(6*t*p)+20*Math.sin(2*t*p))*2/3,a+=(20*Math.sin(e*p)+40*Math.sin(e/3*p))*2/3,a+=(160*Math.sin(e/12*p)+320*Math.sin(e*p/30))*2/3,a},W=(t,e)=>t<72.004||t>137.8347||e<.8293||e>55.8271||!1,X=(t,e)=>{if(t=Number(t),e=Number(e),W(t,e))return[t,e];{let a=P(t-105,e-35),o=F(t-105,e-35),l=e/180*p,s=Math.sin(l);s=1-S*s*s;let n=Math.sqrt(s);a=a*180/(E*(1-S)/(s*n)*p),o=o*180/(E/n*Math.cos(l)*p);let i=e+a;return[t+o,i]}},D=(t,e)=>{const a=X(t,e);return L(a[0],a[1])},I=(t,e)=>{let a=t-.0065,o=e-.006,l=Math.sqrt(a*a+o*o)-2e-5*Math.sin(o*T),s=Math.atan2(o,a)-3e-6*Math.cos(a*T),n=l*Math.cos(s),i=l*Math.sin(s);return[n,i]},de=(t,e)=>{const a=I(t,e);return Q(a[0],a[1])},L=(t,e)=>{let a=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*T),o=Math.atan2(e,t)+3e-6*Math.cos(t*T),l=a*Math.cos(o)+.0065,s=a*Math.sin(o)+.006;return[l,s]},Q=(t,e)=>{if(W(t,e))return[t,e];{let a=P(t-105,e-35),o=F(t-105,e-35),l=e/180*p,s=Math.sin(l);s=1-S*s*s;let n=Math.sqrt(s);a=a*180/(E*(1-S)/(s*n)*p),o=o*180/(E/n*Math.cos(l)*p);let i=e+a,h=t+o;return[t*2-h,e*2-i]}},ie=(t,e,a)=>new Promise((o,l)=>{t.plugin("AMap.Geocoder",()=>{new t.Geocoder().getAddress([e,a],(s,n)=>{if(s==="complete"&&n.info==="OK"){const i=n.regeocode.formattedAddress;o(i)}else l(null)})})}),O=t=>(ee("data-v-dee060bf"),t=t(),te(),t),_e={class:"coordinate-convert"},pe={class:"type-select"},me={class:"coordinate-type-select"},ve=O(()=>g("span",null,"坐标系 : ",-1)),be={class:"initial-coordinate"},he=O(()=>g("span",null,"坐标 : ",-1)),fe={class:"result-coordinate"},ge={class:"coordinate-type-select"},xe=O(()=>g("span",null,"目标坐标系 : ",-1)),Me={class:"batch-coordinate-result"},ye=C({__name:"CoordinateConvert",setup(t){let e=b("single"),a=b(""),o=b([{label:"WGS84(国际通用)",value:"wgs84"},{label:"BD09(百度地图)",value:"bd09"},{label:"GCJ02(高德、QQ地图)",value:"gcj02"}]),l=b(""),s=b({wgs84:"",gcj02:"",bd09:"",address:""}),n=b(""),i=b(""),h=b(!1),y=b("");const G=async()=>{if(!a.value){k.warning("请选择初始坐标系类型");return}if(e.value==="single"){if(!l.value){k.warning("请输入初始坐标");return}const _=l.value.split(",");switch(s.value[a.value]=l.value,a.value){case"wgs84":s.value.gcj02=X(Number(_[0]),Number(_[1])).join(","),s.value.bd09=D(Number(_[0]),Number(_[1])).join(",");break;case"gcj02":s.value.wgs84=Q(Number(_[0]),Number(_[1])).join(","),s.value.bd09=L(Number(_[0]),Number(_[1])).join(",");break;case"bd09":s.value.wgs84=de(Number(_[0]),Number(_[1])).join(","),s.value.gcj02=I(Number(_[0]),Number(_[1])).join(",");break}}else{if(!n.value||!i.value){k.warning(n.value?"请选择目标坐标系类型":"请输入初始坐标");return}if(a.value===i.value){k.warning("经纬度初始类型与转换类型一致");return}h.value=!0;let _=[];switch(i.value){case"wgs84":_=n.value.split(`
`).map(u=>D(Number(u.split(",")[0]),Number(u.split(",")[1])).join(","));break;case"gcj02":_=n.value.split(`
`).map(u=>L(Number(u.split(",")[0]),Number(u.split(",")[1])).join(","));break;case"bd09":_=n.value.split(`
`).map(u=>I(Number(u.split(",")[0]),Number(u.split(",")[1])).join(","));break}y.value=_.join(`
`)}};return(_,u)=>{const N=m("a-radio"),B=m("a-radio-group"),K=m("a-input"),R=m("svg-icon"),z=m("a-button"),H=m("temlpate"),Y=m("a-textarea"),Z=m("a-modal");return f(),x("div",_e,[g("div",pe,[c(B,{modelValue:v(e),"onUpdate:modelValue":u[0]||(u[0]=r=>M(e)?e.value=r:e=r)},{default:d(()=>[c(N,{value:"single"},{default:d(()=>[j("单量")]),_:1}),c(N,{value:"batch"},{default:d(()=>[j("批量")]),_:1})]),_:1},8,["modelValue"])]),g("div",me,[ve,c(B,{modelValue:v(a),"onUpdate:modelValue":u[1]||(u[1]=r=>M(a)?a.value=r:a=r)},{default:d(()=>[(f(!0),x(V,null,q(v(o),r=>(f(),A(N,{value:r.value,key:r.value},{default:d(()=>[j(w(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),v(e)==="single"?(f(),A(H,{key:0},{default:d(()=>[g("div",be,[he,c(K,{class:"coordinate-value",placeholder:"请输入经纬度(逗号隔开)","allow-clear":"",modelValue:v(l),"onUpdate:modelValue":u[2]||(u[2]=r=>M(l)?l.value=r:l=r)},null,8,["modelValue"]),c(z,{type:"primary",onClick:G},{icon:d(()=>[c(R,{name:"convert",size:"15px"})]),default:d(()=>[j(" 转换 ")]),_:1})]),g("ul",fe,[(f(!0),x(V,null,q(v(o),r=>(f(),x("li",{key:r.value,class:"item-result"},[g("span",null,w(r.label),1),g("span",null,w(v(s)[r.value]),1)]))),128))])]),_:1})):(f(),x(V,{key:1},[c(Y,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:v(n),"onUpdate:modelValue":u[3]||(u[3]=r=>M(n)?n.value=r:n=r)},null,8,["modelValue"]),g("div",ge,[xe,c(B,{modelValue:v(i),"onUpdate:modelValue":u[4]||(u[4]=r=>M(i)?i.value=r:i=r)},{default:d(()=>[(f(!0),x(V,null,q(v(o),r=>(f(),A(N,{value:r.value,key:r.value},{default:d(()=>[j(w(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),c(z,{type:"primary",onClick:G},{icon:d(()=>[c(R,{name:"convert",size:"15px"})]),default:d(()=>[j(" 转换 ")]),_:1}),c(Z,{visible:v(h),"onUpdate:visible":u[5]||(u[5]=r=>M(h)?h.value=r:h=r)},{title:d(()=>[j(" 批量转换经纬度结果 ")]),default:d(()=>[g("div",Me,w(v(y)),1)]),_:1},8,["visible"])],64))])}}});const je=J(ye,[["__scopeId","data-v-dee060bf"]]),we={class:"trans-address"},Ce=C({__name:"TransAddress",setup(t){let e=b({});ae(async()=>{e=await oe()});let a=b(""),o=b("");const l=async()=>{o.value="",await Promise.all(a.value.split(`
`).map(async s=>{const n=await ie(e,s.split(",")[0],s.split(",")[1]);o.value?o.value+=`
${n}`:o.value=n}))};return(s,n)=>{const i=m("a-textarea"),h=m("svg-icon");return f(),x("div",we,[c(i,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:v(a),"onUpdate:modelValue":n[0]||(n[0]=y=>M(a)?a.value=y:a=y)},null,8,["modelValue"]),c(h,{class:"exchange",name:"exchange",width:"40px",height:"40px",onClick:l}),c(i,{class:"coordinate-list",modelValue:v(o),"onUpdate:modelValue":n[1]||(n[1]=y=>M(o)?o.value=y:o=y)},null,8,["modelValue"])])}}});const Ne=J(Ce,[["__scopeId","data-v-f0c34752"]]),Ve={class:"data-conversion"},Ee=C({__name:"index",setup(t){return(e,a)=>{const o=m("a-tab-pane"),l=m("a-tabs");return f(),x("div",Ve,[c(l,{"default-active-key":"1"},{default:d(()=>[c(o,{key:"1",title:"EXCEL转JSON"},{default:d(()=>[c(le)]),_:1}),c(o,{key:"2",title:"JSON转EXCEL"},{default:d(()=>[c(ue)]),_:1}),c(o,{key:"3",title:"坐标转换"},{default:d(()=>[c(je)]),_:1}),c(o,{key:"4",title:"高德地址"},{default:d(()=>[c(Ne)]),_:1})]),_:1})])}}});export{Ee as default};
