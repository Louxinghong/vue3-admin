import{d as C,h as v,r as p,o as x,c as V,a as n,k as c,_ as N,f,w as i,b as M,l as h,x as w,y as ae,F as E,i as Y,m as A,t as k,M as S,p as oe,e as se,v as le,z as ne,A as ue,B as G,C as H}from"./index-bee4eec1.js";import{g as re}from"./index-9054b619.js";const de={class:"excel-to-json"},ie=C({__name:"ExcelToJson",setup(a){let e=v([]);const t=o=>{e.value=o};return(o,r)=>{const l=p("file-upload"),s=p("json-viewer");return x(),V("div",de,[n(l,{onSuccess:t}),n(s,{class:"json-viewer",value:c(e),copyable:!0,"expand-depth":2,boxed:""},null,8,["value"])])}}});const ce=N(ie,[["__scopeId","data-v-7e0406bd"]]),_e={class:"json-to-excel"},pe={class:"type-select"},me=C({__name:"JsonToExcel",setup(a){let e=v("single"),t=v("");const o=()=>{const r=w.book_new();if(e.value==="single"){let l=w.json_to_sheet(JSON.parse(t.value));w.book_append_sheet(r,l,"data")}else JSON.parse(t.value).map(l=>{let s=w.json_to_sheet(l.sheetList);w.book_append_sheet(r,s,l.sheetName)});ae(r,"测试表格.xlsx")};return(r,l)=>{const s=p("a-radio"),_=p("a-radio-group"),g=p("a-textarea"),y=p("svg-icon"),j=p("a-button");return x(),V("div",_e,[f("div",pe,[n(_,{modelValue:c(e),"onUpdate:modelValue":l[0]||(l[0]=u=>h(e)?e.value=u:e=u)},{default:i(()=>[n(s,{value:"single"},{default:i(()=>[M("单表")]),_:1}),n(s,{value:"batch"},{default:i(()=>[M("多表")]),_:1})]),_:1},8,["modelValue"])]),n(g,{class:"json-excel",placeholder:"请输入JSON内容",modelValue:c(t),"onUpdate:modelValue":l[1]||(l[1]=u=>h(t)?t.value=u:t=u)},null,8,["modelValue"]),n(j,{class:"btn-convert-json",type:"primary",onClick:o},{icon:i(()=>[n(y,{name:"convert",size:"15px"})]),default:i(()=>[M(" 转换EXCEL ")]),_:1})])}}});const ve=N(me,[["__scopeId","data-v-d0fd3415"]]);let U=3.141592653589793*3e3/180,b=3.141592653589793,D=6378245,J=.006693421622965943;const P=(a,e)=>{let t=300+a+2*e+.1*a*a+.1*a*e+.1*Math.sqrt(Math.abs(a));return t+=(20*Math.sin(6*a*b)+20*Math.sin(2*a*b))*2/3,t+=(20*Math.sin(a*b)+40*Math.sin(a/3*b))*2/3,t+=(150*Math.sin(a/12*b)+300*Math.sin(a/30*b))*2/3,t},W=(a,e)=>{let t=-100+2*a+3*e+.2*e*e+.1*a*e+.2*Math.sqrt(Math.abs(a));return t+=(20*Math.sin(6*a*b)+20*Math.sin(2*a*b))*2/3,t+=(20*Math.sin(e*b)+40*Math.sin(e/3*b))*2/3,t+=(160*Math.sin(e/12*b)+320*Math.sin(e*b/30))*2/3,t},X=(a,e)=>a<72.004||a>137.8347||e<.8293||e>55.8271||!1,Q=(a,e)=>{if(a=Number(a),e=Number(e),X(a,e))return[a,e];{let t=W(a-105,e-35),o=P(a-105,e-35),r=e/180*b,l=Math.sin(r);l=1-J*l*l;let s=Math.sqrt(l);t=t*180/(D*(1-J)/(l*s)*b),o=o*180/(D/s*Math.cos(r)*b);let _=e+t;return[a+o,_]}},R=(a,e)=>{const t=Q(a,e);return O(t[0],t[1])},I=(a,e)=>{let t=a-.0065,o=e-.006,r=Math.sqrt(t*t+o*o)-2e-5*Math.sin(o*U),l=Math.atan2(o,t)-3e-6*Math.cos(t*U),s=r*Math.cos(l),_=r*Math.sin(l);return[s,_]},be=(a,e)=>{const t=I(a,e);return K(t[0],t[1])},O=(a,e)=>{let t=Math.sqrt(a*a+e*e)+2e-5*Math.sin(e*U),o=Math.atan2(e,a)+3e-6*Math.cos(a*U),r=t*Math.cos(o)+.0065,l=t*Math.sin(o)+.006;return[r,l]},K=(a,e)=>{if(X(a,e))return[a,e];{let t=W(a-105,e-35),o=P(a-105,e-35),r=e/180*b,l=Math.sin(r);l=1-J*l*l;let s=Math.sqrt(l);t=t*180/(D*(1-J)/(l*s)*b),o=o*180/(D/s*Math.cos(r)*b);let _=e+t,g=a+o;return[a*2-g,e*2-_]}},fe=(a,e,t)=>new Promise((o,r)=>{a.plugin("AMap.Geocoder",()=>{new a.Geocoder().getAddress([e,t],(l,s)=>{if(l==="complete"&&s.info==="OK"){const _=s.regeocode.formattedAddress;o(_)}else r(null)})})}),q=a=>(oe("data-v-dee060bf"),a=a(),se(),a),he={class:"coordinate-convert"},ge={class:"type-select"},xe={class:"coordinate-type-select"},ye=q(()=>f("span",null,"坐标系 : ",-1)),Me={class:"initial-coordinate"},Ve=q(()=>f("span",null,"坐标 : ",-1)),je={class:"result-coordinate"},Ce={class:"coordinate-type-select"},we=q(()=>f("span",null,"目标坐标系 : ",-1)),ke={class:"batch-coordinate-result"},Ne=C({__name:"CoordinateConvert",setup(a){let e=v("single"),t=v(""),o=v([{label:"WGS84(国际通用)",value:"wgs84"},{label:"BD09(百度地图)",value:"bd09"},{label:"GCJ02(高德、QQ地图)",value:"gcj02"}]),r=v(""),l=v({wgs84:"",gcj02:"",bd09:"",address:""}),s=v(""),_=v(""),g=v(!1),y=v("");const j=async()=>{if(!t.value){S.warning("请选择初始坐标系类型");return}if(e.value==="single"){if(!r.value){S.warning("请输入初始坐标");return}const u=r.value.split(",");switch(l.value[t.value]=r.value,t.value){case"wgs84":l.value.gcj02=Q(Number(u[0]),Number(u[1])).join(","),l.value.bd09=R(Number(u[0]),Number(u[1])).join(",");break;case"gcj02":l.value.wgs84=K(Number(u[0]),Number(u[1])).join(","),l.value.bd09=O(Number(u[0]),Number(u[1])).join(",");break;case"bd09":l.value.wgs84=be(Number(u[0]),Number(u[1])).join(","),l.value.gcj02=I(Number(u[0]),Number(u[1])).join(",");break}}else{if(!s.value||!_.value){S.warning(s.value?"请选择目标坐标系类型":"请输入初始坐标");return}if(t.value===_.value){S.warning("经纬度初始类型与转换类型一致");return}g.value=!0;let u=[];switch(_.value){case"wgs84":u=s.value.split(`
`).map(m=>R(Number(m.split(",")[0]),Number(m.split(",")[1])).join(","));break;case"gcj02":u=s.value.split(`
`).map(m=>O(Number(m.split(",")[0]),Number(m.split(",")[1])).join(","));break;case"bd09":u=s.value.split(`
`).map(m=>I(Number(m.split(",")[0]),Number(m.split(",")[1])).join(","));break}y.value=u.join(`
`)}};return(u,m)=>{const T=p("a-radio"),B=p("a-radio-group"),Z=p("a-input"),L=p("svg-icon"),z=p("a-button"),$=p("temlpate"),ee=p("a-textarea"),te=p("a-modal");return x(),V("div",he,[f("div",ge,[n(B,{modelValue:c(e),"onUpdate:modelValue":m[0]||(m[0]=d=>h(e)?e.value=d:e=d)},{default:i(()=>[n(T,{value:"single"},{default:i(()=>[M("单量")]),_:1}),n(T,{value:"batch"},{default:i(()=>[M("批量")]),_:1})]),_:1},8,["modelValue"])]),f("div",xe,[ye,n(B,{modelValue:c(t),"onUpdate:modelValue":m[1]||(m[1]=d=>h(t)?t.value=d:t=d)},{default:i(()=>[(x(!0),V(E,null,Y(c(o),d=>(x(),A(T,{value:d.value,key:d.value},{default:i(()=>[M(k(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),c(e)==="single"?(x(),A($,{key:0},{default:i(()=>[f("div",Me,[Ve,n(Z,{class:"coordinate-value",placeholder:"请输入经纬度(逗号隔开)","allow-clear":"",modelValue:c(r),"onUpdate:modelValue":m[2]||(m[2]=d=>h(r)?r.value=d:r=d)},null,8,["modelValue"]),n(z,{type:"primary",onClick:j},{icon:i(()=>[n(L,{name:"convert",size:"15px"})]),default:i(()=>[M(" 转换 ")]),_:1})]),f("ul",je,[(x(!0),V(E,null,Y(c(o),d=>(x(),V("li",{key:d.value,class:"item-result"},[f("span",null,k(d.label),1),f("span",null,k(c(l)[d.value]),1)]))),128))])]),_:1})):(x(),V(E,{key:1},[n(ee,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:c(s),"onUpdate:modelValue":m[3]||(m[3]=d=>h(s)?s.value=d:s=d)},null,8,["modelValue"]),f("div",Ce,[we,n(B,{modelValue:c(_),"onUpdate:modelValue":m[4]||(m[4]=d=>h(_)?_.value=d:_=d)},{default:i(()=>[(x(!0),V(E,null,Y(c(o),d=>(x(),A(T,{value:d.value,key:d.value},{default:i(()=>[M(k(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),n(z,{type:"primary",onClick:j},{icon:i(()=>[n(L,{name:"convert",size:"15px"})]),default:i(()=>[M(" 转换 ")]),_:1}),n(te,{visible:c(g),"onUpdate:visible":m[5]||(m[5]=d=>h(g)?g.value=d:g=d)},{title:i(()=>[M(" 批量转换经纬度结果 ")]),default:i(()=>[f("div",ke,k(c(y)),1)]),_:1},8,["visible"])],64))])}}});const Te=N(Ne,[["__scopeId","data-v-dee060bf"]]),Ee={class:"trans-address"},Se=C({__name:"TransAddress",setup(a){let e=v({});le(async()=>{e=await re()});let t=v(""),o=v("");const r=async()=>{o.value="",await Promise.all(t.value.split(`
`).map(async l=>{const s=await fe(e,l.split(",")[0],l.split(",")[1]);o.value?o.value+=`
${s}`:o.value=s}))};return(l,s)=>{const _=p("a-textarea"),g=p("svg-icon");return x(),V("div",Ee,[n(_,{class:"coordinate-list",placeholder:`请输入经纬度以换行隔开, 例如: 
121.222222,23.342122
121.222223,23.342123
121.222224,23.342124`,modelValue:c(t),"onUpdate:modelValue":s[0]||(s[0]=y=>h(t)?t.value=y:t=y)},null,8,["modelValue"]),n(g,{class:"exchange",name:"exchange",size:"40px",onClick:r}),n(_,{class:"coordinate-list",modelValue:c(o),"onUpdate:modelValue":s[1]||(s[1]=y=>h(o)?o.value=y:o=y)},null,8,["modelValue"])])}}});const Ue=N(Se,[["__scopeId","data-v-f246da9d"]]);var De=ne();const F=ue(De),Je={class:"timestamp-convert"},Be={class:"convert-content"},Ye={class:"convert-content"},Ae=C({__name:"TimestampConvert",setup(a){let e=v(0),t=v(""),o=v("");const r=()=>{e.value===0&&(o.value=String(F(t.value).valueOf())),e.value===1&&(t.value=F(Number(o.value)).format("YYYY-MM-DD HH:mm:ss"))};return(l,s)=>{const _=p("a-radio"),g=p("a-radio-group"),y=p("a-date-picker"),j=p("a-input");return x(),V("div",Je,[n(g,{modelValue:c(e),"onUpdate:modelValue":s[0]||(s[0]=u=>h(e)?e.value=u:e=u)},{default:i(()=>[n(_,{value:0},{default:i(()=>[M("时间转换时间戳")]),_:1}),n(_,{value:1},{default:i(()=>[M("时间戳转换时间")]),_:1})]),_:1},8,["modelValue"]),G(f("div",Be,[n(y,{modelValue:c(t),"onUpdate:modelValue":s[1]||(s[1]=u=>h(t)?t.value=u:t=u),"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"]),f("span",{class:"exchange",onClick:r},"->"),n(j,{class:"timestamp",modelValue:c(o),"onUpdate:modelValue":s[2]||(s[2]=u=>h(o)?o.value=u:o=u),placeholder:"请输入时间戳"},null,8,["modelValue"])],512),[[H,c(e)===0]]),G(f("div",Ye,[n(j,{class:"timestamp",modelValue:c(o),"onUpdate:modelValue":s[3]||(s[3]=u=>h(o)?o.value=u:o=u),placeholder:"请输入时间戳"},null,8,["modelValue"]),f("span",{class:"exchange",onClick:r},"->"),n(y,{modelValue:c(t),"onUpdate:modelValue":s[4]||(s[4]=u=>h(t)?t.value=u:t=u),"show-time":"",format:"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])],512),[[H,c(e)===1]])])}}});const Ie=N(Ae,[["__scopeId","data-v-3512ebbd"]]),Oe={class:"data-conversion"},ze=C({__name:"index",setup(a){return(e,t)=>{const o=p("a-tab-pane"),r=p("a-tabs");return x(),V("div",Oe,[n(r,{"default-active-key":"1"},{default:i(()=>[n(o,{key:"1",title:"EXCEL转JSON"},{default:i(()=>[n(ce)]),_:1}),n(o,{key:"2",title:"JSON转EXCEL"},{default:i(()=>[n(ve)]),_:1}),n(o,{key:"3",title:"坐标转换"},{default:i(()=>[n(Te)]),_:1}),n(o,{key:"4",title:"高德地址"},{default:i(()=>[n(Ue)]),_:1}),n(o,{key:"5",title:"时间戳转换"},{default:i(()=>[n(Ie)]),_:1})]),_:1})])}}});export{ze as default};
